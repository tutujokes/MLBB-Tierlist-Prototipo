<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tier List - Mobile Legends</title>
  <style>
    * { box-sizing: border-box; }
    body { margin: 0; font-family: sans-serif; background: #fff; color: #333; }
    header { padding: 1rem; background: #f8f8f8; text-align: center; border-bottom: 1px solid #ddd; }
    select { padding: 0.5rem; margin: 0.5rem; }
    .tier { margin: 2rem auto; max-width: 960px; }
    .tier h2 { font-size: 1.5rem; margin-bottom: 1rem; }
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 1rem; }
    .card { background: #f0f0f0; border-radius: 8px; padding: 0.5rem; text-align: center; }
    .card img { width: 64px; height: 64px; border-radius: 50%; }
    .card .name { font-weight: bold; margin-top: 0.5rem; }
    .card .rate { font-size: 0.8rem; color: #555; }
  </style>
</head>
<body>
  <header>
    <h1>Tier List de Heróis - Mobile Legends</h1>
    <label>Função:
      <select id="roleFilter">
        <option value="Todos">Todas</option>
        <option value="Tank">Tank</option>
        <option value="Fighter">Lutador</option>
        <option value="Assassin">Assassino</option>
        <option value="Mage">Mago</option>
        <option value="Marksman">Atirador</option>
        <option value="Support">Suporte</option>
      </select>
    </label>
    <label>Rota:
      <select id="laneFilter">
        <option value="Todos">Todas</option>
        <option value="Gold">Ouro</option>
        <option value="Exp">EXP</option>
        <option value="Mid">Meio</option>
        <option value="Roam">Rotação</option>
        <option value="Jungle">Selva</option>
      </select>
    </label>
  </header>
  <main id="app"></main>
  <script>
    const tiers = ['SS', 'S', 'A', 'B', 'C'];
    let allHeroes = [];

    async function loadHeroes() {
      try {
        const res = await fetch('https://mlbb-stats.ridwaanhall.com/api/hero-rank/');
        const json = await res.json();
        allHeroes = json.data.map(h => ({
          id: h.hero_id,
          name: h.hero_name,
          image: 'https://mlbb-stats.ridwaanhall.com' + h.hero_icon,
          win: h.win_rate,
          role: h.role || [],
          lane: h.lane || [],
          tier: h.tier
        }));
        render();
      } catch (e) {
        document.getElementById('app').innerHTML = '<p style="padding:2rem;text-align:center">Erro ao carregar os dados da API.</p>';
      }
    }

    function render() {
      const role = document.getElementById('roleFilter').value;
      const lane = document.getElementById('laneFilter').value;
      const container = document.getElementById('app');
      container.innerHTML = '';

      tiers.forEach(tier => {
        const section = document.createElement('section');
        section.className = 'tier';
        const title = document.createElement('h2');
        title.textContent = `Tier ${tier}`;
        section.appendChild(title);

        const grid = document.createElement('div');
        grid.className = 'grid';

        const heroes = allHeroes.filter(h =>
          h.tier === tier &&
          (role === 'Todos' || h.role.some(r => r.includes(role))) &&
          (lane === 'Todos' || h.lane.some(l => l.includes(lane)))
        );

        heroes.forEach(hero => {
          const card = document.createElement('div');
          card.className = 'card';

          const img = document.createElement('img');
          img.src = hero.image;
          img.alt = hero.name;
          card.appendChild(img);

          const name = document.createElement('div');
          name.className = 'name';
          name.textContent = hero.name;
          card.appendChild(name);

          const rate = document.createElement('div');
          rate.className = 'rate';
          rate.textContent = `Taxa de vitória: ${(hero.win * 100).toFixed(1)}%`;
          card.appendChild(rate);

          grid.appendChild(card);
        });

        section.appendChild(grid);
        container.appendChild(section);
      });
    }

    document.getElementById('roleFilter').addEventListener('change', render);
    document.getElementById('laneFilter').addEventListener('change', render);

    loadHeroes();
  </script>
</body>
</html>
